<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MindfulFeed | Settings</title>
    <link rel="stylesheet" href="settings.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>‚öôÔ∏è MindfulFeed Settings</h1>
        <p class="subtitle">Configure AI analysis and extension behavior</p>
      </header>

      <main>
        <!-- AI API Settings -->
        <section class="card">
          <h2>ü§ñ AI Analysis Settings</h2>
          <p class="description">
            Enable advanced AI analysis using OpenAI's latest models for highly accurate content categorization.
            Without an API key, the extension uses NLP heuristics (keyword matching).
          </p>

          <div class="form-group">
            <label for="apiKey">
              OpenAI API Key
              <span class="optional">(optional)</span>
            </label>
            <div class="input-with-button">
              <input
                type="password"
                id="apiKey"
                placeholder="sk-proj-..."
                class="input"
              />
              <button id="toggleApiKey" class="btn-link">Show</button>
            </div>
          </div>

          <div class="info-box">
            <strong>üìù How to get an API key:</strong>
            <ol>
              <li>Visit <a href="https://platform.openai.com/api-keys" target="_blank">platform.openai.com/api-keys</a></li>
              <li>Sign up or log in to your OpenAI account</li>
              <li>Click "Create new secret key"</li>
              <li>Copy and paste it above</li>
              <li><strong>Add credits:</strong> <a href="https://platform.openai.com/account/billing" target="_blank">platform.openai.com/account/billing</a> (min $5)</li>
            </ol>
            <p><strong>Cost:</strong> ~$0.01-0.03 per session (very affordable)</p>
            <p><strong>New users:</strong> OpenAI no longer provides free credits. You must add at least $5 to use the API.</p>
            <p><strong>Privacy:</strong> Your data is sent to OpenAI for analysis. See their <a href="https://openai.com/privacy" target="_blank">privacy policy</a>.</p>
          </div>

          <div class="form-actions">
            <button id="saveSettings" class="btn btn-primary">üíæ Save Settings</button>
            <button id="testApi" class="btn btn-secondary">üß™ Test API</button>
          </div>

          <div id="statusMessage" class="status-message hidden"></div>
        </section>

        <!-- Analysis Mode -->
        <section class="card">
          <h2>üìä Analysis Mode</h2>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="analysisMode" value="heuristic" checked />
              <div class="radio-content">
                <strong>Heuristic Analysis (Default)</strong>
                <p>Fast, offline keyword matching. Free. Good accuracy (~75%).</p>
              </div>
            </label>

            <label class="radio-option">
              <input type="radio" name="analysisMode" value="puter" />
              <div class="radio-content">
                <strong>üéâ Puter.js Free AI (Recommended)</strong>
                <p><strong>FREE unlimited access to GPT-5 & Gemini models!</strong> Best-in-class accuracy (~98%). Requires free Puter app token.</p>
              </div>
            </label>

            <label class="radio-option">
              <input type="radio" name="analysisMode" value="ai" />
              <div class="radio-content">
                <strong>OpenAI Direct API</strong>
                <p>Direct OpenAI API access. Requires paid API key (~$0.01-0.03 per session). Excellent accuracy (~95%).</p>
              </div>
            </label>
          </div>

          <!-- Puter Token Input (shown when Puter mode selected) -->
          <div id="puterTokenSection" class="form-group hidden" style="margin-top: 20px;">
            <label for="puterToken">
              Puter App Token
              <span class="optional">(required for Puter mode)</span>
            </label>
            <div class="input-with-button">
              <input
                type="password"
                id="puterToken"
                placeholder="Enter your Puter app token..."
                class="input"
              />
              <button id="togglePuterToken" class="btn-link">Show</button>
            </div>

            <div class="info-box" style="margin-top: 15px;">
              <strong>üìù How to get a FREE Puter app token:</strong>
              <ol>
                <li>Visit <a href="https://puter.com" target="_blank">puter.com</a> and sign up (free)</li>
                <li>Open <a href="https://puter.com/app/dev-center" target="_blank">Puter Dev Center</a></li>
                <li>Click "Create App" and give it a name (e.g., "MindfulFeed")</li>
                <li>Copy the App Token from the app details</li>
                <li>Paste it above and save settings</li>
              </ol>
              <p><strong>Cost:</strong> 100% FREE - Unlimited API calls!</p>
              <p><strong>Privacy:</strong> Your data is sent to AI providers via Puter's proxy. See <a href="https://puter.com/privacy" target="_blank">Puter privacy policy</a>.</p>
            </div>

            <!-- Model Selection (Puter mode only) -->
            <div class="form-group" style="margin-top: 20px;">
              <label for="aiModel">
                AI Model
                <span class="optional">(choose your preferred model)</span>
              </label>
              <select id="aiModel" class="input">
                <optgroup label="ü§ñ OpenAI Models (FREE via Puter)">
                  <option value="gpt-5">GPT-5 (Recommended) - Best accuracy (~98%)</option>
                  <option value="gpt-5.1">GPT-5.1 - Latest experimental version</option>
                  <option value="gpt-5-chat-latest">GPT-5 Chat Latest - Auto-updated latest</option>
                  <option value="gpt-5-mini">GPT-5 Mini - Faster, good accuracy (~95%)</option>
                  <option value="gpt-5-nano">GPT-5 Nano - Fastest, lighter (~90%)</option>
                </optgroup>
                <optgroup label="üíé Google Gemini Models (FREE via Puter)">
                  <option value="gemini-3-pro-preview">Gemini 3 Pro Preview - Highest quality</option>
                  <option value="gemini-3-flash-preview">Gemini 3 Flash Preview - Fast & accurate</option>
                  <option value="gemini-2.5-pro">Gemini 2.5 Pro - Very capable</option>
                  <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash Lite - Balanced</option>
                  <option value="gemini-2.5-flash">Gemini 2.5 Flash - Quick responses</option>
                </optgroup>
              </select>
              <p style="margin-top: 8px; font-size: 0.875rem; color: #718096;">
                üí° <strong>All models are 100% FREE via Puter.js!</strong> Try different models to find your favorite balance of speed and accuracy.
              </p>
            </div>
          </div>
        </section>

        <!-- Privacy -->
        <section class="card">
          <h2>üîí Privacy</h2>
          <ul class="privacy-list">
            <li>‚úÖ All data stored locally on your device</li>
            <li>‚úÖ No cloud sync or external servers (except optional OpenAI API)</li>
            <li>‚úÖ Anonymous leaderboard IDs (no personal info)</li>
            <li>‚úÖ No tracking pixels or analytics</li>
            <li>‚ö†Ô∏è If using AI mode, captions are sent to OpenAI for analysis</li>
          </ul>
        </section>

        <!-- About -->
        <section class="card">
          <h2>‚ÑπÔ∏è About</h2>
          <p><strong>Version:</strong> 1.0.0</p>
          <p><strong>License:</strong> MIT</p>
          <p>
            <strong>GitHub:</strong>
            <a href="https://github.com/chakirLbr/MindFulFeed" target="_blank">
              github.com/chakirLbr/MindFulFeed
            </a>
          </p>
        </section>
      </main>
    </div>

    <script src="settings.js"></script>
  </body>
</html>
